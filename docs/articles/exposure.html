<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exposure data • TwoSampleMR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exposure data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TwoSampleMR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Guide</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrcieu/TwoSampleMR">Source</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Exposure data</h1>
                        <h4 class="author">Gibran Hemani</h4>
            
      
      
      <div class="hidden name"><code>exposure.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>A data frame of the instruments for an exposure is required. Each line has the information for one variant for one exposure. The minimum information required for MR analysis is the following:</p>
<ul>
<li>
<code>SNP</code> - rs ID</li>
<li>
<code>beta</code> - The effect size. If the trait is binary then log(OR) should be used</li>
<li>
<code>se</code> - The standard error of the effect size</li>
<li>
<code>effect_allele</code> - The allele of the SNP which has the effect marked in <code>beta</code>
</li>
</ul>
<p>Other information that is useful for MR can also be provided:</p>
<ul>
<li>
<code>other_allele</code> - The non-effect allele</li>
<li>
<code>eaf</code> - The effect allele frequency</li>
<li>
<code>Phenotype</code> - The name of the phenotype for which the SNP has an effect</li>
</ul>
<p>You can also provide the following extra information:</p>
<ul>
<li>
<code>chr</code> - Physical position of variant (chromosome)</li>
<li>
<code>position</code> - Physical position of variant (position)</li>
<li>
<code>samplesize</code> - Sample size for estimating the effect size</li>
<li>
<code>ncase</code> - Number of cases</li>
<li>
<code>ncontrol</code> - Number of controls</li>
<li>
<code>pval</code> - The P-value for the SNP’s association with the exposure</li>
<li>
<code>units</code> - The units in which the effects are presented</li>
<li>
<code>gene</code> - The gene or other annotation for the the SNP</li>
</ul>
</div>
<div id="reading-in-from-a-file" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-in-from-a-file" class="anchor"></a>Reading in from a file</h2>
<p>The data can be read in from a text file using the <code>read_exposure_data</code> function. The file must have a header with column names corresponding to the columns described above.</p>
<div id="example-1-the-default-column-names-are-used" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1-the-default-column-names-are-used" class="anchor"></a>Example 1: The default column names are used</h3>
<p>An example of a text file with the default column names is provided as part of the package, the first few rows look like this:</p>
<pre><code>Phenotype SNP beta se effect_allele other_allele eaf pval units gene samplesize
BMI rs10767664 0.19 0.0306122448979592 A T 0.78 5e-26 kg/m2 BDNF 225238
BMI rs13078807 0.1 0.0204081632653061 G A 0.2 4e-11 kg/m2 CADM2 221431
BMI rs1514175 0.07 0.0204081632653061 A G 0.43 8e-14 kg/m2 TNNI3K 207641
BMI rs1558902 0.39 0.0204081632653061 A T 0.42 5e-120 kg/m2 FTO 222476
BMI rs10968576 0.11 0.0204081632653061 G A 0.31 3e-13 kg/m2 LRRN6C 247166
BMI rs2241423 0.13 0.0204081632653061 G A 0.78 1e-18 kg/m2 LBXCOR1 227886</code></pre>
<p>The exact path to the file will be different on everyone’s computer, but it can be located like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>bmi_file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"bmi.txt"</span>, <span class="dt">package=</span><span class="st">"TwoSampleMR"</span>)</span></code></pre></div>
<p>You can read the data in like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>bmi_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_exposure_data.html">read_exposure_data</a></span>(bmi_file)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(bmi_exp_dat)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt;          SNP beta.exposure se.exposure effect_allele.exposure</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; 1 rs10767664          0.19  0.03061224                      A</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; 2 rs13078807          0.10  0.02040816                      G</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; 3  rs1514175          0.07  0.02040816                      A</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; 4  rs1558902          0.39  0.02040816                      A</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt; 5 rs10968576          0.11  0.02040816                      G</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; 6  rs2241423          0.13  0.02040816                      G</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt;   other_allele.exposure eaf.exposure pval.exposure units.exposure</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; 1                     T         0.78         5e-26          kg/m2</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; 2                     A         0.20         4e-11          kg/m2</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt; 3                     G         0.43         8e-14          kg/m2</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt; 4                     T         0.42        5e-120          kg/m2</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">#&gt; 5                     A         0.31         3e-13          kg/m2</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">#&gt; 6                     A         0.78         1e-18          kg/m2</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">#&gt;   gene.exposure samplesize.exposure exposure mr_keep.exposure</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">#&gt; 1          BDNF              225238      BMI             TRUE</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">#&gt; 2         CADM2              221431      BMI             TRUE</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">#&gt; 3        TNNI3K              207641      BMI             TRUE</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">#&gt; 4           FTO              222476      BMI             TRUE</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">#&gt; 5        LRRN6C              247166      BMI             TRUE</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">#&gt; 6       LBXCOR1              227886      BMI             TRUE</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="co">#&gt;   pval_origin.exposure units.exposure_dat id.exposure data_source.exposure</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co">#&gt; 1             reported              kg/m2      moNCTq             textfile</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">#&gt; 2             reported              kg/m2      moNCTq             textfile</span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co">#&gt; 3             reported              kg/m2      moNCTq             textfile</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="co">#&gt; 4             reported              kg/m2      moNCTq             textfile</span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="co">#&gt; 5             reported              kg/m2      moNCTq             textfile</span></span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="co">#&gt; 6             reported              kg/m2      moNCTq             textfile</span></span></code></pre></div>
<p>The output from this function is a new data frame with standardised column names:</p>
<ul>
<li><code>SNP</code></li>
<li><code>exposure</code></li>
<li><code>beta.exposure</code></li>
<li><code>se.exposure</code></li>
<li><code>effect_allele.exposure</code></li>
<li><code>other_allele.exposure</code></li>
<li><code>eaf.exposure</code></li>
<li><code>mr_keep.exposure</code></li>
<li><code>pval.exposure</code></li>
<li><code>pval_origin.exposure</code></li>
<li><code>id.exposure</code></li>
<li><code>data_source.exposure</code></li>
<li><code>units.exposure</code></li>
<li><code>gene.exposure</code></li>
<li><code>samplesize.exposure</code></li>
</ul>
<p>The function attempts to match the columns to the ones it expects. It also checks that the data type is as expected.</p>
<p>If the required data for MR to be performed is not present (SNP name, effect size, standard error, effect allele) for a particular SNP, then the column <code>mr_keep.exposure</code> will be “FALSE”.</p>
</div>
<div id="example-2-the-text-file-has-non-default-column-names" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2-the-text-file-has-non-default-column-names" class="anchor"></a>Example 2: The text file has non-default column names</h3>
<p>If the text file does not have default column names, this can still be read in as follows. Here are the first few rows of an example:</p>
<pre><code>rsid,effect,SE,a1,a2,a1_freq,p-value,Units,Gene,n
rs10767664,0.19,0.030612245,A,T,0.78,5.00E-26,kg/m2,BDNF,225238
rs13078807,0.1,0.020408163,G,A,0.2,4.00E-11,kg/m2,CADM2,221431
rs1514175,0.07,0.020408163,A,G,0.43,8.00E-14,kg/m2,TNNI3K,207641
rs1558902,0.39,0.020408163,A,T,0.42,5.00E-120,kg/m2,FTO,222476</code></pre>
<p>Note that this is a CSV file, with commas separating fields. The file is located here:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>bmi2_file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/bmi.csv"</span>, <span class="dt">package=</span><span class="st">"TwoSampleMR"</span>)</span></code></pre></div>
<p>To read in this data:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>bmi_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_exposure_data.html">read_exposure_data</a></span>(</span>
<span id="cb6-2"><a href="#cb6-2"></a>    <span class="dt">filename =</span> bmi2_file,</span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="dt">sep =</span> <span class="st">","</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="dt">snp_col =</span> <span class="st">"rsid"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="dt">beta_col =</span> <span class="st">"effect"</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>    <span class="dt">se_col =</span> <span class="st">"SE"</span>,</span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="dt">effect_allele_col =</span> <span class="st">"a1"</span>,</span>
<span id="cb6-8"><a href="#cb6-8"></a>    <span class="dt">other_allele_col =</span> <span class="st">"a2"</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="dt">eaf_col =</span> <span class="st">"a1_freq"</span>,</span>
<span id="cb6-10"><a href="#cb6-10"></a>    <span class="dt">pval_col =</span> <span class="st">"p-value"</span>,</span>
<span id="cb6-11"><a href="#cb6-11"></a>    <span class="dt">units_col =</span> <span class="st">"Units"</span>,</span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="dt">gene_col =</span> <span class="st">"Gene"</span>,</span>
<span id="cb6-13"><a href="#cb6-13"></a>    <span class="dt">samplesize_col =</span> <span class="st">"n"</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>)</span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co">#&gt; No phenotype name specified, defaulting to 'exposure'.</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(bmi_exp_dat)</span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co">#&gt;          SNP beta.exposure se.exposure effect_allele.exposure</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co">#&gt; 1 rs10767664          0.19  0.03061224                      A</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#&gt; 2 rs13078807          0.10  0.02040816                      G</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">#&gt; 3  rs1514175          0.07  0.02040816                      A</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co">#&gt; 4  rs1558902          0.39  0.02040816                      A</span></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">#&gt; 5 rs10968576          0.11  0.02040816                      G</span></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co">#&gt; 6  rs2241423          0.13  0.02040816                      G</span></span>
<span id="cb6-24"><a href="#cb6-24"></a><span class="co">#&gt;   other_allele.exposure eaf.exposure pval.exposure units.exposure</span></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co">#&gt; 1                     T         0.78         5e-26          kg/m2</span></span>
<span id="cb6-26"><a href="#cb6-26"></a><span class="co">#&gt; 2                     A         0.20         4e-11          kg/m2</span></span>
<span id="cb6-27"><a href="#cb6-27"></a><span class="co">#&gt; 3                     G         0.43         8e-14          kg/m2</span></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="co">#&gt; 4                     T         0.42        5e-120          kg/m2</span></span>
<span id="cb6-29"><a href="#cb6-29"></a><span class="co">#&gt; 5                     A         0.31         3e-13          kg/m2</span></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="co">#&gt; 6                     A         0.78         1e-18          kg/m2</span></span>
<span id="cb6-31"><a href="#cb6-31"></a><span class="co">#&gt;   gene.exposure samplesize.exposure exposure mr_keep.exposure</span></span>
<span id="cb6-32"><a href="#cb6-32"></a><span class="co">#&gt; 1          BDNF              225238 exposure             TRUE</span></span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="co">#&gt; 2         CADM2              221431 exposure             TRUE</span></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="co">#&gt; 3        TNNI3K              207641 exposure             TRUE</span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="co">#&gt; 4           FTO              222476 exposure             TRUE</span></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="co">#&gt; 5        LRRN6C              247166 exposure             TRUE</span></span>
<span id="cb6-37"><a href="#cb6-37"></a><span class="co">#&gt; 6       LBXCOR1              227886 exposure             TRUE</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="co">#&gt;   pval_origin.exposure units.exposure_dat id.exposure data_source.exposure</span></span>
<span id="cb6-39"><a href="#cb6-39"></a><span class="co">#&gt; 1             reported              kg/m2      vqFFyw             textfile</span></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="co">#&gt; 2             reported              kg/m2      vqFFyw             textfile</span></span>
<span id="cb6-41"><a href="#cb6-41"></a><span class="co">#&gt; 3             reported              kg/m2      vqFFyw             textfile</span></span>
<span id="cb6-42"><a href="#cb6-42"></a><span class="co">#&gt; 4             reported              kg/m2      vqFFyw             textfile</span></span>
<span id="cb6-43"><a href="#cb6-43"></a><span class="co">#&gt; 5             reported              kg/m2      vqFFyw             textfile</span></span>
<span id="cb6-44"><a href="#cb6-44"></a><span class="co">#&gt; 6             reported              kg/m2      vqFFyw             textfile</span></span></code></pre></div>
<p>If the <code>Phenotype</code> column is not provided (as is the case in this example) then it will assume that the phenotype’s name is simply “exposure”. This is entered in the <code>exposure</code> column. It can be renamed manually:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>bmi_exp_dat<span class="op">$</span>exposure &lt;-<span class="st"> "BMI"</span></span></code></pre></div>
</div>
</div>
<div id="using-an-existing-data-frame" class="section level2">
<h2 class="hasAnchor">
<a href="#using-an-existing-data-frame" class="anchor"></a>Using an existing data frame</h2>
<p>If the data already exists as a data frame in R then it can be converted into the correct format using the <code>format_data</code> function. For example, here is some randomly created data:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>random_df &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</span>
<span id="cb8-2"><a href="#cb8-2"></a>    <span class="dt">SNP =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"rs1"</span>, <span class="st">"rs2"</span>),</span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="dt">beta =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="dt">se =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="dt">effect_allele =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>, <span class="st">"T"</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>random_df</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;   SNP beta se effect_allele</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt; 1 rs1    1  1             A</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; 2 rs2    2  2             T</span></span></code></pre></div>
<p>This can be formatted like so:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>random_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_data.html">format_data</a></span>(random_df, <span class="dt">type=</span><span class="st">"exposure"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">#&gt; No phenotype name specified, defaulting to 'exposure'.</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt; Warning in format_data(random_df, type = "exposure"): The following columns are not present but are helpful for harmonisation</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; other_alleleeaf</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; Warning in format_data(random_df, type = "exposure"): effect_allele column</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">#&gt; is not character data. Coercing...</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">#&gt; Inferring p-values</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>random_exp_dat</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#&gt;   SNP beta.exposure se.exposure effect_allele.exposure exposure</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; 1 rs1             1           1                      A exposure</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt; 2 rs2             2           2                      T exposure</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt;   mr_keep.exposure pval.exposure pval_origin.exposure id.exposure</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt; 1             TRUE     0.1586553             inferred      iE54Wz</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt; 2             TRUE     0.1586553             inferred      iE54Wz</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt;   other_allele.exposure eaf.exposure</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt; 1                    NA           NA</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt; 2                    NA           NA</span></span></code></pre></div>
</div>
<div id="obtaining-instruments-from-existing-catalogues" class="section level2">
<h2 class="hasAnchor">
<a href="#obtaining-instruments-from-existing-catalogues" class="anchor"></a>Obtaining instruments from existing catalogues</h2>
<p>A number of sources of instruments have already been curated and are available for use. They are provided as data objects in the <code>MRInstruments</code> package. To install:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"MRCIEU/MRInstruments"</span>)</span></code></pre></div>
<p>This package contains a number of data.frames, each of which is a repository of SNP-trait associations. How to access the data frames is detailed below:</p>
<div id="gwas-catalog" class="section level3">
<h3 class="hasAnchor">
<a href="#gwas-catalog" class="anchor"></a>GWAS catalog</h3>
<p>The NHGRI-EBI GWAS catalog contains a catalog of significant associations obtained from GWASs. This version of the data is filtered and harmonised to contain associations that have the required data to perform MR, to ensure that the units used to report effect sizes from a particular study are all the same, and other data cleaning operations.</p>
<p>To use the GWAS catalog:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(MRInstruments)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(gwas_catalog)</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(gwas_catalog)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt;                       Phenotype_simple</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; 1                    Eosinophil counts</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; 2 Eosinophil percentage of white cells</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; 3             Post bronchodilator FEV1</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; 4        Cisplatin-induced ototoxicity</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; 5                      Crohn's disease</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; 6                    IgG glycosylation</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt;                                       MAPPED_TRAIT_EFO</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt; 1                                     eosinophil count</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; 2                  eosinophil percentage of leukocytes</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; 3 forced expiratory volume, response to bronchodilator</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; 4                   ototoxicity, response to cisplatin</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt; 5                                      Crohn's disease</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; 6                  serum IgG glycosylation measurement</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt;                                                              MAPPED_TRAIT_EFO_URI</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt; 1                                            http://www.ebi.ac.uk/efo/EFO_0004842</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#&gt; 2                                            http://www.ebi.ac.uk/efo/EFO_0007991</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#&gt; 3 http://www.ebi.ac.uk/efo/EFO_0004314, http://purl.obolibrary.org/obo/GO_0097366</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#&gt; 4 http://www.ebi.ac.uk/efo/EFO_0006951, http://purl.obolibrary.org/obo/GO_0072718</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">#&gt; 5                                            http://www.ebi.ac.uk/efo/EFO_0000384</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">#&gt; 6                                            http://www.ebi.ac.uk/efo/EFO_0005193</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">#&gt;                                                                                                                                                Initial_sample_description</span></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="co">#&gt; 1                                                                                                                                   172,275 European ancestry individuals</span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">#&gt; 2                                                                                                                                   172,378 European ancestry individuals</span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">#&gt; 3 10,094 European ancestry current and former smoker individuals, 3,260 African American current and former smoker individuals, 178 current and former smoker individuals</span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co">#&gt; 4                                                                                                            511 European ancestry testicular cancer survivor individuals</span></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="co">#&gt; 5                                                                                                         1,748 European ancestry cases, 2,938 European ancestry controls</span></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co">#&gt; 6                                                                                                                                     2,247 European ancestry individuals</span></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="co">#&gt;   Replication_sample_description STUDY.ACCESSION</span></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="co">#&gt; 1                           &lt;NA&gt;      GCST004606</span></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="co">#&gt; 2                           &lt;NA&gt;      GCST004600</span></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="co">#&gt; 3                           &lt;NA&gt;      GCST003262</span></span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="co">#&gt; 4                   238 children      GCST003898</span></span>
<span id="cb11-37"><a href="#cb11-37"></a><span class="co">#&gt; 5              (see Parkes 2007)      GCST000042</span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="co">#&gt; 6                           &lt;NA&gt;      GCST001848</span></span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="co">#&gt;                              Phenotype Phenotype_info PubmedID     Author</span></span>
<span id="cb11-40"><a href="#cb11-40"></a><span class="co">#&gt; 1                    Eosinophil counts                27863252   Astle WJ</span></span>
<span id="cb11-41"><a href="#cb11-41"></a><span class="co">#&gt; 2 Eosinophil percentage of white cells                27863252   Astle WJ</span></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="co">#&gt; 3             Post bronchodilator FEV1                26634245    Lutz SM</span></span>
<span id="cb11-43"><a href="#cb11-43"></a><span class="co">#&gt; 4        Cisplatin-induced ototoxicity                28039263 Wheeler HE</span></span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="co">#&gt; 5                      Crohn's disease                17554300      WTCCC</span></span>
<span id="cb11-45"><a href="#cb11-45"></a><span class="co">#&gt; 6                    IgG glycosylation        (IGP23) 23382691     Lauc G</span></span>
<span id="cb11-46"><a href="#cb11-46"></a><span class="co">#&gt;   Year        SNP chr bp_ens_GRCh38   Region       gene</span></span>
<span id="cb11-47"><a href="#cb11-47"></a><span class="co">#&gt; 1 2016  rs1000005  21      33060745 21q22.11 AP000282.2</span></span>
<span id="cb11-48"><a href="#cb11-48"></a><span class="co">#&gt; 2 2016  rs1000005  21      33060745 21q22.11 AP000282.2</span></span>
<span id="cb11-49"><a href="#cb11-49"></a><span class="co">#&gt; 3 2015 rs10000225   4     144312789  4q31.21 Intergenic</span></span>
<span id="cb11-50"><a href="#cb11-50"></a><span class="co">#&gt; 4 2016  rs1000083   5      97197765     5q15 intergenic</span></span>
<span id="cb11-51"><a href="#cb11-51"></a><span class="co">#&gt; 5 2007  rs1000113   5     150860514   5q33.1       IRGM</span></span>
<span id="cb11-52"><a href="#cb11-52"></a><span class="co">#&gt; 6 2013 rs10002492   4      12578222  4p15.33         NR</span></span>
<span id="cb11-53"><a href="#cb11-53"></a><span class="co">#&gt;               Gene_ens effect_allele other_allele        beta          se</span></span>
<span id="cb11-54"><a href="#cb11-54"></a><span class="co">#&gt; 1 AP000282.2,LINC00945             C            G -0.02481715 0.003571429</span></span>
<span id="cb11-55"><a href="#cb11-55"></a><span class="co">#&gt; 2 AP000282.2,LINC00945             C            G -0.02652552 0.003826531</span></span>
<span id="cb11-56"><a href="#cb11-56"></a><span class="co">#&gt; 3           Intergenic             A            T -0.04400000 0.009420188</span></span>
<span id="cb11-57"><a href="#cb11-57"></a><span class="co">#&gt; 4           intergenic             T            C -4.55000000 0.996760478</span></span>
<span id="cb11-58"><a href="#cb11-58"></a><span class="co">#&gt; 5                 IRGM             T            C  0.43178242 0.083879940</span></span>
<span id="cb11-59"><a href="#cb11-59"></a><span class="co">#&gt; 6                   NR             G            A -0.18370000 0.040816327</span></span>
<span id="cb11-60"><a href="#cb11-60"></a><span class="co">#&gt;    pval            units       eaf date_added_to_MRBASE</span></span>
<span id="cb11-61"><a href="#cb11-61"></a><span class="co">#&gt; 1 7e-12    unit decrease 0.5894000           2018-02-14</span></span>
<span id="cb11-62"><a href="#cb11-62"></a><span class="co">#&gt; 2 2e-13    unit decrease 0.5894000           2018-02-14</span></span>
<span id="cb11-63"><a href="#cb11-63"></a><span class="co">#&gt; 3 3e-06 NR unit decrease 0.3500000           2018-02-14</span></span>
<span id="cb11-64"><a href="#cb11-64"></a><span class="co">#&gt; 4 5e-06 z score decrease        NA           2018-02-14</span></span>
<span id="cb11-65"><a href="#cb11-65"></a><span class="co">#&gt; 5 3e-07             &lt;NA&gt; 0.0700000           2018-02-14</span></span>
<span id="cb11-66"><a href="#cb11-66"></a><span class="co">#&gt; 6 8e-06    unit decrease 0.1672272           2018-02-14</span></span></code></pre></div>
<p>For example, to obtain instruments for body mass index using the Speliotes et al 2010 study:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>bmi_gwas &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(gwas_catalog, <span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"Speliotes"</span>, Author) <span class="op">&amp;</span><span class="st"> </span>Phenotype <span class="op">==</span><span class="st"> "Body mass index"</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>bmi_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_data.html">format_data</a></span>(bmi_gwas)</span></code></pre></div>
</div>
<div id="metabolites" class="section level3">
<h3 class="hasAnchor">
<a href="#metabolites" class="anchor"></a>Metabolites</h3>
<p>Independent top hits from GWASs on 121 metabolites in whole blood are stored in the <code>metab_qtls</code> data object. Use <code><a href="https://rdrr.io/pkg/MRInstruments/man/metab_qtls.html">?metab_qtls</a></code> to get more information.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(metab_qtls)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(metab_qtls)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt;   phenotype chromosome  position       SNP effect_allele other_allele</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; 1     AcAce          8   9181395 rs2169387             G            A</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; 2     AcAce         11 116648917  rs964184             C            G</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; 3       Ace          6  12042473 rs6933521             C            T</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; 4       Ala          2  27730940 rs1260326             C            T</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt; 5       Ala          2  65220910 rs2160387             C            T</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; 6       Ala         12  47201814 rs4554975             G            A</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt;        eaf      beta       se     pval n_studies     n</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt; 1 0.870251  0.085630 0.015451 3.61e-08        11 19257</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt; 2 0.857715 -0.096027 0.014624 6.71e-11        11 19261</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">#&gt; 3 0.120256 -0.091667 0.015885 8.10e-09        14 24742</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">#&gt; 4 0.638817 -0.104582 0.009940 7.40e-26        13 22569</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">#&gt; 5 0.403170 -0.071001 0.009603 1.49e-13        14 24793</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co">#&gt; 6 0.644059 -0.069135 0.009598 6.12e-13        14 24792</span></span></code></pre></div>
<p>For example, to obtain instruments for the Alanine:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>ala_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_metab_qtls.html">format_metab_qtls</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(metab_qtls, phenotype<span class="op">==</span><span class="st">"Ala"</span>))</span></code></pre></div>
</div>
<div id="proteins" class="section level3">
<h3 class="hasAnchor">
<a href="#proteins" class="anchor"></a>Proteins</h3>
<p>Independent top hits from GWASs on 47 protein levels in whole blood are stored in the <code>proteomic_qtls</code> data object. Use <code><a href="https://rdrr.io/pkg/MRInstruments/man/proteomic_qtls.html">?proteomic_qtls</a></code> to get more information.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(proteomic_qtls)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(proteomic_qtls)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#&gt;   analyte chr  position        SNP  gene location annotation other_allele</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt; 1   CFHR1   1 196698945 rs12144939   CFH      cis   missense            T</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; 2    IL6r   1 154425456 rs12126142  IL6R      cis   missense            A</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; 3   ApoA4  11 116677723  rs1263167 APOA4      cis intergenic            G</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; 4    SELE   9 136149399   rs507666   ABO    trans   intronic            A</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; 5 FetuinA   3 186335941  rs2070633  AHSG      cis   missense            T</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; 6     ACE  17  61566031     rs4343   ACE      cis synonymous            A</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt;   effect_allele   eaf   maf      pval   beta         se</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; 1             G 0.643 0.357 8.99e-143 -1.108 0.04355258</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt; 2             G 0.608 0.392 1.81e-106  0.850 0.03878364</span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">#&gt; 3             A 0.803 0.197  2.64e-54 -0.919 0.05922332</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">#&gt; 4             G 0.809 0.191  1.01e-52 -0.882 0.05771545</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">#&gt; 5             C 0.676 0.324  2.88e-44 -0.629 0.04506925</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt; 6             G 0.508 0.492  6.66e-44  0.493 0.03547679</span></span></code></pre></div>
<p>For example, to obtain instruments for the ApoH protein:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>apoh_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_proteomic_qtls.html">format_proteomic_qtls</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(proteomic_qtls, analyte<span class="op">==</span><span class="st">"ApoH"</span>))</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#&gt; Warning in format_data(proteomic_qtls_subset, type = type, phenotype_col =</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt; "analyte"): effect_allele column is not character data. Coercing...</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt; Warning in format_data(proteomic_qtls_subset, type = type, phenotype_col =</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; "analyte"): other_allele column is not character data. Coercing...</span></span></code></pre></div>
</div>
<div id="gene-expression-levels" class="section level3">
<h3 class="hasAnchor">
<a href="#gene-expression-levels" class="anchor"></a>Gene expression levels</h3>
<p>Independent top hits from GWASs on 32432 gene identifiers and in 44 tissues are available from the GTEX study in <code>gtex_eqtl</code>. Use <code><a href="https://rdrr.io/pkg/MRInstruments/man/gtex_eqtl.html">?gtex_eqtl</a></code> to get more information.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(gtex_eqtl)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(gtex_eqtl)</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#&gt;                 tissue     gene_name gene_start         SNP snp_position</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt; 1 Adipose Subcutaneous RP4-669L17.10   1:317720   rs2519065     1:787151</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">#&gt; 2 Adipose Subcutaneous RP11-206L10.1   1:661611  rs11804171     1:723819</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">#&gt; 3 Adipose Subcutaneous RP11-206L10.3   1:677193 rs149110718     1:759227</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">#&gt; 4 Adipose Subcutaneous RP11-206L10.2   1:700306 rs148649543     1:752796</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#&gt; 5 Adipose Subcutaneous RP11-206L10.9   1:714150  rs12184279     1:717485</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt; 6 Adipose Subcutaneous RP11-206L10.8   1:736259  rs10454454     1:754954</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#&gt;   effect_allele other_allele      beta        se        pval   n</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">#&gt; 1             A            G  0.551788 0.0747180 2.14627e-12 298</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">#&gt; 2             A            T -0.917475 0.1150060 4.99967e-14 298</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">#&gt; 3             T            C  0.807571 0.1776530 8.44694e-06 298</span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="co">#&gt; 4             T            C  0.745393 0.0958531 1.82660e-13 298</span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co">#&gt; 5             A            C  1.927250 0.2247390 9.55098e-16 298</span></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co">#&gt; 6             A            G  1.000400 0.1787470 5.61079e-08 298</span></span></code></pre></div>
<p>For example, to obtain instruments for the IRAK1BP1 gene expression levels in subcutaneous adipose tissue:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>irak1bp1_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_gtex_eqtl.html">format_gtex_eqtl</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(gtex_eqtl, gene_name<span class="op">==</span><span class="st">"IRAK1BP1"</span> <span class="op">&amp;</span><span class="st"> </span>tissue <span class="op">==</span><span class="st"> "Adipose Subcutaneous"</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">#&gt; Warning in format_data(gtex_eqtl_subset, type = type, phenotype_col = type, : The following columns are not present but are helpful for harmonisation</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt; eaf</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; Inferring p-values</span></span></code></pre></div>
</div>
<div id="dna-methylation-levels" class="section level3">
<h3 class="hasAnchor">
<a href="#dna-methylation-levels" class="anchor"></a>DNA methylation levels</h3>
<p>Independent top hits from GWASs on 0 DNA methylation levels in whole blood across 5 time points are available from the ARIES study in <code>aries_mqtl</code>. Use <code><a href="https://rdrr.io/pkg/MRInstruments/man/aries_mqtl.html">?aries_mqtl</a></code> to get more information.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(aries_mqtl)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(aries_mqtl)</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt;          SNP timepoint        cpg    beta        pval         se snp_chr</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt; 1 esv2656832         1 cg21826606  0.3459 1.60408e-26 0.03265336       1</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">#&gt; 2 esv2658098         1 cg22681495 -0.6263 1.55765e-66 0.03643240      15</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">#&gt; 3 esv2660043         1 cg24276624 -0.5772 3.16370e-26 0.05481823      11</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">#&gt; 4 esv2660043         1 cg11157765 -0.5423 1.33928e-22 0.05583777      11</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">#&gt; 5 esv2660673         1 cg05832925 -0.5919 2.88011e-50 0.03982467      11</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">#&gt; 6 esv2660769         1 cg05859533 -0.6224 1.49085e-58 0.03868158      16</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co">#&gt;    snp_pos effect_allele other_allele    eaf   sex   age    units</span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">#&gt; 1 25591901             I            R 0.3974 mixed Birth SD units</span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">#&gt; 2 86057007             D            R 0.2076 mixed Birth SD units</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co">#&gt; 3 69982552             D            R 0.1450 mixed Birth SD units</span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">#&gt; 4 69982552             D            R 0.1450 mixed Birth SD units</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">#&gt; 5 74024905             D            R 0.1671 mixed Birth SD units</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co">#&gt; 6 57725395             D            R 0.2136 mixed Birth SD units</span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co">#&gt;   island_location cpg_chr  cpg_pos    gene gene_location cis_trans</span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">#&gt; 1         N_Shore       1 25593055                             cis</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#&gt; 2                      15 86058755  AKAP13          Body       cis</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">#&gt; 3                      11 69982941    ANO1          Body       cis</span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#&gt; 4                      11 69982996    ANO1          Body       cis</span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#&gt; 5         S_Shelf      11 74026371                             cis</span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co">#&gt; 6                      16 57727230 CCDC135       TSS1500       cis</span></span></code></pre></div>
<p>For example, to obtain instruments for cg25212131 CpG DNA methylation levels in at birth:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>cg25212131_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/format_aries_mqtl.html">format_aries_mqtl</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(aries_mqtl, cpg<span class="op">==</span><span class="st">"cg25212131"</span> <span class="op">&amp;</span><span class="st"> </span>age <span class="op">==</span><span class="st"> "Birth"</span>))</span></code></pre></div>
</div>
<div id="ieu-gwas-database" class="section level3">
<h3 class="hasAnchor">
<a href="#ieu-gwas-database" class="anchor"></a>IEU GWAS database</h3>
<p>The IEU GWAS database contains the entire summary statistics for thousands of GWASs. You can browse them here: <a href="https://gwas.mrcieu.ac.uk/" class="uri">https://gwas.mrcieu.ac.uk/</a></p>
<p>You can use this database to define the instruments for a particular exposure. You can also use this database to obtain the effects for constructing polygenic risk scores using different p-value thresholds.</p>
<p>You can check the status of the API:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>ieugwasr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ieugwasr/man/api_status.html">api_status</a></span>()</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co">#&gt; API: public: https://gwas-api.mrcieu.ac.uk/</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#&gt; $`API version`</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co">#&gt; [1] "0.3.2"</span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="co">#&gt; </span></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co">#&gt; $Access</span></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co">#&gt; [1] "public"</span></span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="co">#&gt; </span></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co">#&gt; $`Neo4j status`</span></span>
<span id="cb21-10"><a href="#cb21-10"></a><span class="co">#&gt; [1] "Available"</span></span>
<span id="cb21-11"><a href="#cb21-11"></a><span class="co">#&gt; </span></span>
<span id="cb21-12"><a href="#cb21-12"></a><span class="co">#&gt; $`ElasticSearch status`</span></span>
<span id="cb21-13"><a href="#cb21-13"></a><span class="co">#&gt; [1] "Available"</span></span>
<span id="cb21-14"><a href="#cb21-14"></a><span class="co">#&gt; </span></span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="co">#&gt; $`LD reference panel`</span></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="co">#&gt; [1] "Available"</span></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="co">#&gt; </span></span>
<span id="cb21-18"><a href="#cb21-18"></a><span class="co">#&gt; $`PLINK executable`</span></span>
<span id="cb21-19"><a href="#cb21-19"></a><span class="co">#&gt; [1] "Available"</span></span>
<span id="cb21-20"><a href="#cb21-20"></a><span class="co">#&gt; </span></span>
<span id="cb21-21"><a href="#cb21-21"></a><span class="co">#&gt; $Cromwell</span></span>
<span id="cb21-22"><a href="#cb21-22"></a><span class="co">#&gt; [1] "Available"</span></span>
<span id="cb21-23"><a href="#cb21-23"></a><span class="co">#&gt; </span></span>
<span id="cb21-24"><a href="#cb21-24"></a><span class="co">#&gt; $`Total associations`</span></span>
<span id="cb21-25"><a href="#cb21-25"></a><span class="co">#&gt; [1] 111216940568</span></span>
<span id="cb21-26"><a href="#cb21-26"></a><span class="co">#&gt; </span></span>
<span id="cb21-27"><a href="#cb21-27"></a><span class="co">#&gt; $`Total complete datasets`</span></span>
<span id="cb21-28"><a href="#cb21-28"></a><span class="co">#&gt; [1] 11104</span></span>
<span id="cb21-29"><a href="#cb21-29"></a><span class="co">#&gt; </span></span>
<span id="cb21-30"><a href="#cb21-30"></a><span class="co">#&gt; attr(,"class")</span></span>
<span id="cb21-31"><a href="#cb21-31"></a><span class="co">#&gt; [1] "ApiStatus"</span></span></code></pre></div>
<p>To obtain a list and details about the available GWASs do the following:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>ao &lt;-<span class="st"> </span><span class="kw"><a href="../reference/available_outcomes.html">available_outcomes</a></span>()</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(ao)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#&gt; # A tibble: 6 x 20</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt;   id    trait sample_size   nsnp  year consortium author note  access    mr</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;       &lt;int&gt;  &lt;int&gt; &lt;int&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;int&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#&gt; 1 prot… Hete…        3301 1.05e7  2018 NA         Sun BB NA    public     1</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#&gt; 2 ukb-… Diag…      337199 1.09e7  2017 Neale Lab  Neale  NA    public     1</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">#&gt; 3 ubm-… NET1…        7916 1.17e7  2018 NA         Ellio… NA    public     1</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">#&gt; 4 prot… Tumo…        3301 1.05e7  2018 NA         Sun BB NA    public     1</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">#&gt; 5 prot… Ribo…        3301 1.05e7  2018 NA         Sun BB NA    public     1</span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">#&gt; 6 prot… Mito…        3301 1.05e7  2018 NA         Sun BB NA    public     1</span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="co">#&gt; # … with 10 more variables: sex &lt;chr&gt;, pmid &lt;int&gt;, priority &lt;int&gt;,</span></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="co">#&gt; #   population &lt;chr&gt;, unit &lt;chr&gt;, category &lt;chr&gt;, subcategory &lt;chr&gt;,</span></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="co">#&gt; #   ncase &lt;int&gt;, ncontrol &lt;int&gt;, sd &lt;dbl&gt;</span></span></code></pre></div>
<p>For information about authentication see <a href="https://github.com/MRCIEU/ieugwasr/blob/master/README.md#authentication">https://github.com/MRCIEU/ieugwasr/blob/master/README.md#authentication</a>.</p>
<p>The <code>available_outcomes</code> function returns a table of all the available studies in the database. Each study has a unique ID. e.g.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(ao, <span class="dt">select=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(trait, id)))</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">#&gt; # A tibble: 6 x 2</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">#&gt;   trait                                                         id         </span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt;   &lt;chr&gt;                                                         &lt;chr&gt;      </span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">#&gt; 1 Heterogeneous nuclear ribonucleoprotein A/B                   prot-a-1363</span></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#&gt; 2 Diagnoses - main ICD10: M24 Other specific joint derangements ukb-a-567  </span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">#&gt; 3 NET100 0411                                                   ubm-a-1567 </span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co">#&gt; 4 Tumor necrosis factor alpha-induced protein 3                 prot-a-3030</span></span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">#&gt; 5 Ribosyldihydronicotinamide dehydrogenase [quinone]            prot-a-2084</span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">#&gt; 6 Mitochondrial ubiquitin ligase activator of NFKB 1            prot-a-1970</span></span></code></pre></div>
<p>To extract instruments for a particular trait using a particular study, for example to obtain SNPs for body mass index using the Locke et al 2015 GIANT study, you specify the study ID as follows:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>bmi2014_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/extract_instruments.html">extract_instruments</a></span>(<span class="dt">outcomes=</span><span class="st">'ieu-a-2'</span>)</span></code></pre></div>
<p>This returns a set of LD clumped SNPs that are GWAS significant for BMI. You can specify various parameters for this function:</p>
<ul>
<li>
<code>p1</code> = P-value threshold for keeping a SNP</li>
<li>
<code>clump</code> = Whether or not to return independent SNPs only (default=TRUE)</li>
<li>
<code>r2</code> = The maximum LD R-square allowed between returned SNPs</li>
<li>
<code>kb</code> = The distance in which to search for LD R-square values</li>
</ul>
<p>By changing changing the <code>p1</code> parameter it is possible to obtain SNP effects for constructing polygenic risk scores.</p>
</div>
</div>
<div id="clumping" class="section level2">
<h2 class="hasAnchor">
<a href="#clumping" class="anchor"></a>Clumping</h2>
<p>For standard two sample MR it is important to ensure that the instruments for the exposure are independent. Once instruments have been identified for an exposure variable, the IEU GWAS database can be used to perform clumping.</p>
<p>The European samples from the 1000 genomes project are used to estimate LD between SNPs. You can provide a list of SNP IDs, the SNPs will be extracted from 1000 genomes data, LD calculated between them, and amongst those SNPs that have LD R-square above the specified threshold only the SNP with the lowest P-value will be retained. To do this, use the following command:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>bmi_exp_dat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clump_data.html">clump_data</a></span>(bmi_exp_dat)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="co">#&gt; Warning: 'clump_data' is deprecated.</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co">#&gt; Use 'ieugwasr::ld_clump()' instead.</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co">#&gt; See help("Deprecated")</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co">#&gt; Warning: since v0.4.2 the default r2 value for clumping has changed from 0.01 to 0.001</span></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co">#&gt; Clumping vqFFyw, 30 variants</span></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="co">#&gt; Removing 3 of 30 variants due to LD with other variants or absence from LD reference panel</span></span></code></pre></div>
<p>The <code>clump_data</code> command takes any data frame that has been formatted to be an exposure data type of data frame. Note that for the instruments in the R/MRInstruments package the SNPs are already LD clumped.</p>
<p><strong>Note:</strong> The LD reference panel only includes SNPs (no INDELs), with MAF &gt; 0.01 in 1000 genomes European samples. Therefore, if a variant is dropped from your unclumped data it could be because it is absent from the reference panel. For more flexibility, including using your own LD reference data, see here: <a href="https://mrcieu.github.io/ieugwasr/" class="uri">https://mrcieu.github.io/ieugwasr/</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#reading-in-from-a-file">Reading in from a file</a></li>
      <li><a href="#using-an-existing-data-frame">Using an existing data frame</a></li>
      <li><a href="#obtaining-instruments-from-existing-catalogues">Obtaining instruments from existing catalogues</a></li>
      <li><a href="#clumping">Clumping</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gibran Hemani, Philip Haycock, Jie Zheng, Tom Gaunt, Ben Elsworth, Tom Palmer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
